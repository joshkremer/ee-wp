jQuery(document).ready(function(e){

// e(".scroll-down").on('click', function() {
//     $('html, body').animate({
//         scrollTop: $('article.post').offset().top - 100
//     },600); 
//     return false;
// });

	// setTimeout(function(){
	    // $('iframe[src*="youtube.com"]').each(function(int) {
	    //     $(this).parent('p').before('<div class="vid-iframe vid-iframe-yt-'+ int +'"></div>');

	    //     var dataSRC = $(this).attr('data-src');
	    //     $(this).removeAttr('class').attr('src',dataSRC).appendTo( $( '.vid-iframe-yt-'+ int ) );
	    // }); 

	    // $('iframe[src*="vimeo.com"]').each(function(int) {
	    //     // e(this).wrap('<div class="vid-iframe"></div>');
	    //     $(this).parent('p').before('<div class="vid-iframe vid-iframe-vm-'+ int +'"></div>');

	    //     var dataSRC = $(this).attr('data-src');
	    //     $(this).removeAttr('class').attr('src',dataSRC).appendTo( $( '.vid-iframe-vm-'+ int ) );
	    // }); 

	    // $('iframe[data-src*="youtube.com"]').each(function(int) {
	    //     // e(this).wrap('<div class="vid-iframe"></div>');
	    //     $(this).parent('p').before('<div class="vid-iframe vid-iframe-dyt-'+ int +'"></div>');

	    //     var dataSRC = $(this).attr('data-src');
	    //     $(this).removeAttr('class').attr('src',dataSRC).appendTo( $( '.vid-iframe-dyt-'+ int ) );
	    // }); 

	    // $('iframe[data-src*="vimeo.com"]').each(function(int) {
	    //     // e(this).wrap('<div class="vid-iframe"></div>');
	    //     $(this).parent('p').before('<div class="vid-iframe vid-iframe-dvm-'+ int +'"></div>');

	    //     var dataSRC = $(this).attr('data-src');
	    //     $(this).removeAttr('class').attr('src',dataSRC).appendTo( $( '.vid-iframe-dvm-'+ int ) );
		// });
		
		// $('.site-header .selector__categories').clone().appendTo( $('.mob-flyouts') );

		// $('.toggle-cats').on('click',function(){
		// 	var $this = $(this),
		// 		mobFlyouts = $('.mob-flyouts');
		// 	if( $this.hasClass('active') ){
		// 		$this.removeClass('active');
		// 		mobFlyouts.removeClass('active');
		// 	}else{
		// 		$this.addClass('active');
		// 		mobFlyouts.addClass('active');
		// 	}
		// 	return false;
		// });

		// $('.posts_carousel .post-info').removeAttr('style');

		// $('.scroll-top').on('click',function(){
		// 	$('html, body').animate({
		// 		scrollTop: 0
		// 	},600);
		// 	return false;
		// });

		// $(window).scroll(function(){
		// 	var _top    = $(window).scrollTop(),
		// 		body   = $('body');
		// 	if( _top > 100 ){
		// 		body.addClass('scrolled');
		// 	}else{
		// 		body.removeClass('scrolled');
		// 	}
		// });

		// updateImgs();

		// e('.vid-frame').each(function(){
		// 	var $this = e(this),
		// 		parent = $this.parent('p');
		// 	parent.after( $this );
		// });	    
	// },2000)

	e("#Learn a").on("mouseover",function(){var window_width=e(window).width();e(".site-header__toggle").is(":hidden")&&window_width>782?e(".learn__container").fadeIn().css("display","flex"):window_width<=782&&e(".learn__container").fadeIn().css("display","flex")}),e(".learn__container").on("mouseleave",function(){e(".learn__container").fadeOut()}),e(".banner__arrow").on("click",function(){var scrollto=e(".site-main .banner").offset().top+e(".site-main .banner").innerHeight();e("body, html").animate({scrollTop:scrollto},1e3)}),e(".links-list li").on("hover",function(){var previewbtn='<div class="quick-look"><img src="/site-files/2017/07/quick-look.png" /><div class="tooltip"><p>QUICK</p></div></div>';e(this).append(previewbtn)}),e(".links-list li").on("mouseleave",function(e){"div.quick-look"!=e.target&&e(this).find(".quick-look").remove()}),e(document).on("click",".quick-look",function(){console.log("click");var post_id=e(this).parent().attr("id");e("html, body").css("cursor","wait"),e.ajax({type:"POST",url:MyAjax.ajaxurl,data:{action:"get_quick_look",post_id:post_id},success:function(data){e("body").append(data),e(".quick-look-overlay").fadeIn(function(){var boxheight=e(".quick-look-container").innerHeight();e(".quick-look-container div:first-child").css("height",boxheight),e("html, body").css("cursor","default")}).css("display","flex")}})}),e(document).on("click",".quick-look-meta span",function(){var parent=e(this).closest(".quick-look-overlay");parent.fadeOut(function(){parent.detach()})}),e(".tab_cats li a").on("click",function(){var _this=e(this),_archive;return e(".archive-container").hide(),e(_this.attr("href")).show(),!1}),e(".home_tab_cats li a").on("click",function(){return window.location=e(this).attr("href"),!1}),e(".learn__container .selector__categories li a, .post-link__meta .selector__categories li a").on("click",function(){window.location=e(this).attr("href")}),e(document).on("click",".archive-load-more a",function(){var _this=e(this),post_type="ee_guides",page_type="",offset=0,firstpost=e(".archive-container .post-link").eq(0).attr("id"),cat=location.href.split("?")[1],tag=location.href.split("?")[1],custom_cat_name=e(".single-article-name").data("cat-custom-name");if(e(".active_nav_bar_section").data("id"))var term_id=e(".active_nav_bar_section").data("id");if(null==e(this).attr("id")&&e(this).attr("id","lazyload"),null==term_id)var url=window.location.pathname.split("/"),taxonomy=url[1],cat_name=url[2];if("articles-categories"==taxonomy||"guides-categories"==taxonomy){offset=parseInt(e(".grid-item ").length);var sum=[]}else var offset=parseInt(e(".grid-item .post-link").length);e("html, body").css("cursor","wait"),e("#content").css("display","block");var carousel_items=e(".posts_carousel .owl-item:not(.cloned)").length;if(offset+=carousel_items,e(this).data("page_type"))var page_type=e(this).data("page_type");if(e(this).data("target")){var target=e(e(this).data("target"));offset=e(this).data("offset"),e(this).data("cat_name")&&(cat_name=e(this).data("cat_name")),console.log("offset "+offset),post_type=""}else var target=e(".grid");_this.hide(),_this.next("#content").show(),e.ajax({type:"POST",dataType:"json",url:MyAjax.ajaxurl,data:{action:"get_lazy_load_posts",offset:offset,type:post_type,firstpost:firstpost,taxonomy:taxonomy,cat_name:cat_name,term_id:term_id,sum:sum,custom_cat_name:custom_cat_name,page_type:page_type},success:function(data){var content_to_append=[];e.each(data,function(key,value){var $content=e(value);content_to_append.push($content)}),target.append(content_to_append),e(".archive-load-more a").css("display",""),data.length<6&&e(".load-more").remove(),data.length>0&&_this.show(),_this.data("target")&&_this.data("offset",offset+12),e("html, body").css("cursor","default"),e("#content").css("display","none"),_this.next("#content").hide()}})}),e(document).on("click",".archive-load a",function(){var offset=parseInt(e(".archive-container .post-link").length);null==e(this).attr("id")&&e(this).attr("id","lazyload"),e("html, body").css("cursor","wait"),e("#content").css("display","block"),e.ajax({type:"POST",dataType:"json",url:MyAjax.ajaxurl,data:{action:"get_lazy_load_posts",offset:offset,type:"ee_articles"},success:function(data){var content_to_append=[];e.each(data,function(key,value){var $content=e(value);content_to_append.push($content)}),e(".archive-load a").css("display",""),e(".grid").append($content_to_append),data.length<6&&$(".load-more").remove(),e("html, body").css("cursor","default"),e("#content").css("display","none")}})}),e("body").on("DOMSubtreeModified",".disqus-comment-count",function(){/*var _string,_numbers=$(".disqus-comment-count").text().match(/\d+/g).map(Number);$(".response-num").empty().text(_numbers)*/}),e(".toggle-comments").on("click",function(){var _this=e(this),_thread=e("#disqus_thread");return _thread.is(":hidden")?(_this.addClass("active"),_thread.show()):(_this.removeClass("active"),_thread.hide()),!1})});



(function($) {

	$(function(){
		$(".scroll-down").on('click', function() {
			$('html, body').animate({
				scrollTop: $('article.post').offset().top - 100
			},600);
			return false;
		});

		$('iframe[data-src*="vimeo.com"]').each(function(int) {
			// e(this).wrap('<div class="vid-iframe"></div>');
			$(this).parent('p').before('<div class="vid-iframe vid-iframe-dvm-'+ int +'"></div>');

			var dataSRC = $(this).attr('data-src');
			$(this).removeAttr('class').attr('src',dataSRC).appendTo( $( '.vid-iframe-dvm-'+ int ) );
		});

		$('.site-header .selector__categories').clone().appendTo( $('.mob-flyouts') );

		$('.toggle-cats').on('click',function(){
			var $this = $(this),
				mobFlyouts = $('.mob-flyouts');
			if( $this.hasClass('active') ){
				$this.removeClass('active');
				mobFlyouts.removeClass('active');
			}else{
				$this.addClass('active');
				mobFlyouts.addClass('active');
			}
			return false;
		});

		$('.posts_carousel .post-info').removeAttr('style');

		$('.scroll-top').on('click',function(){
			$('html, body').animate({
				scrollTop: 0
			},600);
			return false;
		});

		updateImgs();
	});

	$(window).scroll(function(){
		var _top    = $(window).scrollTop(),
			body   = $('body');
		if( _top > 100 ){
			body.addClass('scrolled');
		}else{
			body.removeClass('scrolled');
		}

		if( $('#ajax-target').length && $('#ajax-target .post-link__hover:not([style])').length ){
			$('#ajax-target .post-link__hover:not([style])').each(function(){
				var $this = $(this);
				// console.log( 'bg ' + $this.data('bg') );
				$this.css('backgroundImage','url(' + $this.data('bg') + ')');
			});
		}

		if( $('.content--related').length && $('.content--related .post-link__hover:not([style])').length ){
			console.log('replacing related-images......');
			$('.content--related .post-link__hover:not([style])').each(function(){
				var $this = $(this);
				$this.css('backgroundImage','url(' + $this.data('bg') + ')');
			});
		}
	});

	$(window).on('load',function(){
		updateImgs();

		if( $('.hero-caption').length ){
			setTimeout(function(){
				$('.hero-caption').fadeIn();
			},1000);
		}
	});

	function updateImgs(){
		// console.log('updateImgs loaded....');

		$('.post-section div[data-bg]').each(function(){
			var $this = $(this);
			// console.log( 'bg ' + $this.data('bg') );
			$this.css('backgroundImage','url(' + $this.data('bg') + ')');
		});

		$('.post-link__hover--lg[data-bg]').each(function(){
			var $this = $(this);
			// console.log( 'bg ' + $this.data('bg') );
			$this.css('backgroundImage','url(' + $this.data('bg') + ')');
		});

		$('.trade-post[data-bg]').each(function(){
			var $this = $(this);
			// console.log( 'bg ' + $this.data('bg') );
			$this.css('backgroundImage','url(' + $this.data('bg') + ')');
		});

		$('.post-link__hover.owl-lazy').each(function(){
			var $this = $(this);
			$this.css('backgroundImage','url(' + $this.data('src') + ')');
		});

		if( $('.content--related').length ){
			$('.content--related .post-link__hover.owl-lazy').each(function(){
				var $this = $(this);
				$this.css('backgroundImage','url(' + $this.data('bg') + ')');
			});
		}
	}
})(jQuery);